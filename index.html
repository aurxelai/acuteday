<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Story | Valentine 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Quicksand:wght@300;500&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; background: #fff5f5; overflow: hidden; font-family: 'Quicksand', sans-serif; }
        
        /* The UI Overlay */
        #game-ui {
            position: fixed; top: 20px; left: 20px; z-index: 10;
            background: rgba(255, 255, 255, 0.8); padding: 15px;
            border-radius: 15px; border: 1px solid #ffcad4;
        }
        #location-tag { font-family: 'Dancing Script', cursive; font-size: 28px; color: #ff4d6d; }
        .progress-bar { width: 150px; height: 8px; background: #eee; border-radius: 4px; margin-top: 5px; overflow: hidden; }
        #fill { width: 0%; height: 100%; background: #ff4d6d; transition: 0.3s; }

        /* The Story Modal */
        #modal {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 70%; max-width: 600px; background: white; padding: 40px;
            border-radius: 30px; text-align: center; display: none; z-index: 100;
            box-shadow: 0 20px 50px rgba(255, 182, 193, 0.4); border: 2px solid #ffcad4;
        }
        #modal.royal { 
            background: #5e0000; color: #f1d279; border: 3px solid #f1d279;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }
        #modal.royal h2 { font-family: 'Dancing Script', cursive; color: #f1d279; }
        #modal.royal button { background: #f1d279; color: #5e0000; }

        h2 { font-family: 'Dancing Script', cursive; font-size: 36px; color: #ff4d6d; margin-top: 0; }
        .photo-slot { 
            width: 100%; height: 280px; background: #fdf2f2; border-radius: 20px; 
            margin-bottom: 20px; overflow: hidden; border: 1px dashed #ffb6c1;
            display: flex; align-items: center; justify-content: center;
        }
        .photo-slot img { width: 100%; height: 100%; object-fit: cover; }
        
        button { 
            background: #ff4d6d; color: white; border: none; padding: 12px 35px;
            border-radius: 25px; font-size: 18px; cursor: pointer; transition: 0.3s;
        }
        button:hover { transform: scale(1.05); background: #ff758c; }
    </style>
</head>
<body>

<div id="game-ui">
    <div id="location-tag">Abu Dhabi</div>
    <div style="font-size: 12px; color: #888;">Collect 3 memories to continue</div>
    <div class="progress-bar"><div id="fill"></div></div>
</div>

<div id="modal">
    <h2 id="m-title">Abu Dhabi</h2>
    <div class="photo-slot">
        <img id="m-img" src="" style="display:none;">
        <span id="m-label" style="color:#ffb6c1;">â™¥ Place your memory photo here â™¥</span>
    </div>
    <p id="m-text">Where it all began...</p>
    <button onclick="nextMilestone()">Continue our story â†’</button>
</div>

<script>
const MILESTONES = [
    { name: "Abu Dhabi", icon: "âœ¨", item: "â˜•", bg: "#fff9f0", story: "Our first meeting. The desert sun had nothing on your smile.", photo: "" },
    { name: "Our Early Dates", icon: "ðŸŽˆ", item: "ðŸ¦", bg: "#fff0f5", story: "Getting to know you was my favorite adventure.", photo: "" },
    { name: "Almaty, Kazakhstan", icon: "ðŸ”ï¸", item: "â„ï¸", bg: "#f0f8ff", story: "The Shymbulak mountains were cold, but you kept me warm.", photo: "" },
    { name: "Prague & Budapest", icon: "ðŸ°", item: "ðŸº", bg: "#f7f0ff", story: "From the Charles Bridge to the glow of the Ruin Bars.", photo: "" },
    { name: "Japan Journey", icon: "ðŸŒ¸", item: "ðŸ£", bg: "#fff0f0", story: "Walking through cherry blossoms in Tokyo with you.", photo: "" },
    { name: "Long Distance", icon: "âœˆï¸", item: "ðŸ’Œ", bg: "#f0f5f5", story: "Every airport goodbye was just a countdown to the next hello.", photo: "" },
    { name: "Philippines", icon: "ðŸï¸", item: "ðŸ¥¥", bg: "#f0fff4", story: "Island sunsets and the realization that you're my forever.", photo: "" },
    { name: "The Shaadi", icon: "ðŸ’", item: "ðŸ””", bg: "#4a0000", story: "Our Royal Mahal. The day we promised forever.", royal: true, photo: "" },
    { name: "The Future", icon: "ðŸ’", item: "â¤ï¸", bg: "#300000", story: "I want every tomorrow to start with you.\n\nWill you be my Valentine?", royal: true, final: true, photo: "" }
];

class JourneyScene extends Phaser.Scene {
    constructor() { super('JourneyScene'); }

    create() {
        this.idx = 0;
        this.collected = 0;
        this.isPaused = false;
        
        // 1. Setup Camera and Background
        this.cameras.main.setBackgroundColor(MILESTONES[0].bg);
        
        // 2. Player (Cute Heart Avatar)
        this.player = this.add.text(this.scale.width/2, this.scale.height - 100, 'â˜ï¸', { fontSize: '60px' }).setOrigin(0.5);
        this.physics.add.existing(this.player);
        this.player.body.setCollideWorldBounds(true);
        
        // 3. Floating Items
        this.items = this.physics.add.group();
        this.spawnItems();

        // 4. Input
        this.cursors = this.input.keyboard.createCursorKeys();
        
        // 5. Logic
        this.physics.add.overlap(this.player, this.items, (p, item) => {
            item.destroy();
            this.collected++;
            document.getElementById('fill').style.width = (this.collected/3 * 100) + '%';
            if(this.collected >= 3) this.triggerModal();
        });
    }

    spawnItems() {
        for(let i=0; i<3; i++) {
            let x = Phaser.Math.Between(100, this.scale.width - 100);
            let y = Phaser.Math.Between(100, this.scale.height - 300);
            let it = this.add.text(x, y, MILESTONES[this.idx].item, { fontSize: '40px' }).setOrigin(0.5);
            this.physics.add.existing(it);
            this.items.add(it);
            
            this.tweens.add({ targets: it, y: y-20, duration: 1500, yoyo: true, repeat: -1 });
        }
    }

    update() {
        if(this.isPaused) { this.player.body.setVelocity(0); return; }
        
        let speed = 400;
        if(this.cursors.left.isDown) this.player.body.setVelocityX(-speed);
        else if(this.cursors.right.isDown) this.player.body.setVelocityX(speed);
        else this.player.body.setVelocityX(0);

        if(this.cursors.up.isDown || this.input.activePointer.isDown) {
            this.player.body.setVelocityY(-speed);
            this.player.setText('ðŸ•Šï¸'); // Character "flies"
        } else {
            this.player.body.setVelocityY(speed/2);
            this.player.setText('â˜ï¸');
        }
    }

    triggerModal() {
        this.isPaused = true;
        const m = MILESTONES[this.idx];
        const modal = document.getElementById('modal');
        
        document.getElementById('m-title').innerText = m.name;
        document.getElementById('m-text').innerText = m.story;
        document.getElementById('location-tag').innerText = m.name;
        
        if(m.royal) modal.classList.add('royal');
        
        if(m.photo) {
            document.getElementById('m-img').src = m.photo;
            document.getElementById('m-img').style.display = "block";
            document.getElementById('m-label').style.display = "none";
        }

        modal.style.display = 'block';
    }
}

const config = {
    type: Phaser.AUTO,
    width: window.innerWidth,
    height: window.innerHeight,
    parent: 'game-container',
    physics: { default: 'arcade' },
    scene: JourneyScene
};

const game = new Phaser.Game(config);

function nextMilestone() {
    const scene = game.scene.scenes[0];
    document.getElementById('modal').style.display = 'none';
    
    if(scene.idx < MILESTONES.length - 1) {
        scene.idx++;
        scene.collected = 0;
        document.getElementById('fill').style.width = '0%';
        scene.cameras.main.setBackgroundColor(MILESTONES[scene.idx].bg);
        scene.spawnItems();
        scene.isPaused = false;
    }
}
</script>
</body>
</html>
